import { vigilanceAreaActions, VigilanceAreaFormTypeOpen } from '@features/VigilanceArea/slice'
import { VigilanceArea } from '@features/VigilanceArea/types'
import { displayOrHideOtherLayers } from '@features/VigilanceArea/useCases/displayOrHideOtherLayers'
import { useAppDispatch } from '@hooks/useAppDispatch'
import { Accent, Button, Icon, Label } from '@mtes-mct/monitor-ui'
import { useFormikContext } from 'formik'

import { RegulatoryAreas } from './RegulatoryAreas'

export function AddRegulatoryAreas() {
  const {
    values: { linkedRegulatoryAreas }
  } = useFormikContext<VigilanceArea.VigilanceArea>()

  const dispatch = useAppDispatch()
  const addRegulatory = () => {
    dispatch(vigilanceAreaActions.setFormTypeOpen(VigilanceAreaFormTypeOpen.ADD_REGULATORY))
    dispatch(displayOrHideOtherLayers({ display: false }))
  }

  return (
    <div>
      <Label>Réglementations en lien avec la zone de vigilance</Label>
      <Button
        accent={Accent.SECONDARY}
        aria-label="Ajouter une réglementation en lien"
        Icon={Icon.Plus}
        isFullWidth
        onClick={addRegulatory}
      >
        Ajouter une réglementation en lien
      </Button>

      <RegulatoryAreas linkedRegulatoryAreas={linkedRegulatoryAreas} />
    </div>
  )
}
